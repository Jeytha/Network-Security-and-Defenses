# Network-Security-and-Defenses
Providing network security for a conceptualised e-commerce company
Network Topology
The company has the network below. 192.168.60.0/24 is an internal network where many ‎employees need to access for internal services and customer database. 10.9.0.0/24 is the DMZ ‎where many public services are offered to LB’s customers. ‎

The virtual machine is available at https://seedsecuritylabs.org/labsetup.html. Other virtual ‎machines are not allowed. The Docker network setting file for this topology can be downloaded ‎from: ‎
‎(for Intel chip) https://seedsecuritylabs.org/Labs_20.04/Files/Firewall/Labsetup.zip .  ‎
‎(for ARM chip) https://seedsecuritylabs.org/Labs_20.04/Files/Firewall/Labsetup-arm.zip.‎
Network Topology
Luna Bags (LB) employed a segmented network topology designed to separate and secure different types of devices and services. The network architecture consisted of three primary zones: the External Network (Internet), the Demilitarised Zone (DMZ), and the Internal Network. The external network primarily consisted of Luna bags' public-facing services, where customers, suppliers and external stockholders will have access to interaction. The DMZ acted as a buffer zone between the external and internal networks. In the DMZ, Luna Bags hosts public services such as the company’s web server, located at IP address 10.9.0.5. The advantage of hosting the DMZ on the web server as the company's website limits potential attackers' ability to move directly into internal systems, even if the web server is compromised. The Internal Network (192.168.60.0/24) houses critical company assets, including employee workstations, sensitive databases, administrative tools, and other confidential resources. This network was protected with strict firewall rules that prevent unauthorised external access.
Executive summary
The installation of an Apache web server in the DMZ served as a critical service for external customers to access the company’s website. This server is located at IP address 10.9.0.5 and is accessible over port 80 (HTTP). A VPN was securely set up using a pre-configured OpenVPN file with embedded certificates, enabling encrypted TLS-based authentication. IP forwarding and static routing were configured to allow traffic between the DMZ and internal network through the VPN tunnel. NAT rules ensured proper return traffic flow without exposing internal IPs. Connectivity and traffic monitoring confirmed secure, bidirectional communication through the encrypted tunnel. Luna Bags (LB) also requires a robust intrusion detection strategy to monitor and detect potential security incidents across both the DMZ and the internal network. The selected tool for this purpose was Snort. Snort is configured to monitor traffic and identify attacks, and provide real-time alerts. To protect Luna Bags' network infrastructure, a host-based firewall was implemented using iptables on the SEED virtual machine. The firewall is designed to enforce network segmentation by regulating traffic between the DMZ and the internal network. Its primary purpose is to minimise attack surfaces, prevent lateral movement by threat actors, and ensure that only authorised traffic flows between different network zones. Further to strengthen Luna Bags' cybersecurity posture, our team implemented a Security Information and Event Management (SIEM) system using Splunk. Splunk is installed to monitor and analyse network traffic directed towards both the DMZ and the internal network. Splunk collects logs, analyses traffic, and generates real-time alerts to detect anomalies, respond to threats, and ensure compliance. 
 Technical solution 
4.1 Apache Web Server Installation and Configuration
The Apache web server setup began by installing the generic Apache HTTP server on the designated host (10.9.0.5) within the DMZ network. To verify that the Apache server is accessible from the terminal or command line, we use curl to send an HTTP request to the server, which indicates the server is successfully up and running.
4.2 Virtual Private Network 
OpenVPN was selected because of its flexibility and the strong encryption standards
followed (TLS/SSL-based), along with its ease of integration with Linux-based
environments. The VPN was set up using a pre-configured OpenVPN file with built-in certificates, enabling secure TLS-based authentication. Packet forwarding was enabled to route traffic between the DMZ and internal network, and a static route ensured traffic to internal hosts went through the VPN. NAT was applied to allow return traffic from internal hosts to the DMZ. A router container SEED-ROUTER used host network mode to access the VPN interface directly. Traffic monitoring and connectivity tests confirmed secure, bidirectional communication through the encrypted tunnel, validating that routing and VPN settings worked correctly.


4.3 Intrusion Detection 
Snort was chosen keeping in mind it is a powerful intrusion detection and prevention system (IDS/IPS) that monitors network traffic in real-time to detect suspicious patterns, known threats, and potential attacks. Its customizable rule-based engine allows security teams to quickly respond to evolving threats.
Snort was set up to monitor the following traffic:
DMZ to External Network (Internet-facing services, e.g., web server). HOME_NET: the internal network range (192.168.60.0/24).
DMZ to Internal Network (communications between public-facing services and sensitive internal systems).EXTERNAL_NET: the DMZ range and external IPs (10.9.0.0/24).
 Snort was configured to log events and generate alerts using Syslog for logging, which was then integrated with centralised log management systems, Splunk, to store and analyse logs generated by Snort’s alerts.
 4.4 SIEM Tool - Splunk
Splunk was chosen as  a robust Security Information and Event Management (SIEM) tool used to collect, analyze, and visualize logs and security events from various systems. It enhances visibility into the security posture, supports threat detection, incident investigation, and compliance reporting. 
Splunk was installed and configured to accept syslog data (sourcetype=syslog) from network devices and servers. Snort logs were transferred to the syslog directory, and the repository was pulled into Splunk for analysis. The installation process began by downloading and installing Splunk Enterprise for Linux, enabling it to listen on port 514 for incoming syslog messages. After the installation, Splunk’s web interface was accessed, and data inputs were configured to receive logs from the Apache web server and internal hosts.  Log sources included system logs, firewall logs, Snort logs, and network activity logs from both 10.9.0.5 (DMZ web server) and internal systems (192.168.60.0/24 network). The successful integration was confirmed by viewing live log events with correct timestamps and sources.  
4.5 Firewall Policies
Before establishing firewall policies, an nmap scan and netstat scan were conducted on the seed router, which acted as a bridge, and the internal hosts, nmap was used to identify open ports, services, and potential vulnerabilities across the network, netstat provided considerable information into active connections, listening ports, and network activity. 
The following iptables rules were defined to produce a moderately restrictive firewall configuration:

Incoming TCP to port 23 (Telnet) is blocked (REJECT), and outgoing TCP from port 23 is also blocked.


Incoming and outgoing TCP to port 80 (HTTP) are allowed (ACCEPT).


Incoming and outgoing TCP to port 22 (SSH) are allowed.


Incoming and outgoing TCP/UDP on high ports (32768-61000) are permitted.


These rules blocked the insecure Telnet protocol while allowing essential services, i.e Luna Bags Website and SSH for secure remote administration. The allowance for high-range ephemeral ports (32768-61000) facilitates support for various client-server applications and network protocols.
Utilised curl to make an HTTP GET request to the IP address 10.9.0.5. The response The successful retrieval of the default page indicated that the firewall rules on 'Host A' are allowing inbound HTTP traffic on port 80. Furthermore, also tested the Apache2 default page image to confirm it shows that a web server is running and accessible at the IP address 10.9.0.5. That means that HTTP traffic (web traffic) was successfully reaching the server, and the server is responding. Explicitly, the iptables rules direct the firewall to accept any incoming TCP traffic that is destined for port 80.  
Next, an attempt was made to establish an SSH connection to the host with the IP address 10.9.0.5 using the command ssh root@10.9.0.5. SSH operates on TCP port 22 by default. The rule on the target host (10.9.0.5) allows incoming TCP traffic destined for port 22. This is what makes it possible for the SSH connection attempt to even reach the SSH server running on 10.9.0.5. If this rule were absent or set to REJECT, the connection would likely time out or be refused immediately.
4.3.1 Assumption: 
Telnet is now an outdated protocol which is not used anymore, and secure protocols (SSH) are assumed to be the norm for remote administration. Further, secure remote management is assumed to be handled solely through SSH, with no need for other remote access protocols. Besides, dynamic communication between services (such as Docker containers) requires high ephemeral ports, and the assumption is that these services are needed for proper functionality.
Recommendations and Reflections
Several recommendations and reflections can enhance Luna Bags' security posture and network monitoring capabilities when implementing Snort, Splunk, and firewall policies.
VPN setup between the DMZ and internal network created a secure, encrypted tunnel, protecting internal data while maintaining segmentation. OpenVPN enabled safe communication without exposing internal resources to public networks or reconnaissance attacks. Routing and NAT configurations ensured seamless bidirectional traffic without static routes, and Docker host mode simplified VPN access. This setup reduced risks like packet sniffing and lateral movement in case of a DMZ breach. However, misconfigured routes or mishandled credentials could disrupt communication or cause security gaps. To mitigate risks, strong certificate-based access, MFA, credential rotation, firewall restrictions, and regular traffic monitoring are recommended.
Snort, as an intrusion detection and prevention system (IDS/IPS), should be configured to monitor both the DMZ and internal networks. It can be fine-tuned to detect potential attacks like DDoS, port scans, and other malicious activities. It's crucial to ensure Snort is continuously updated with the latest rule sets to detect emerging threats. However, the performance of Snort could be impacted in a high-traffic environment, requiring periodic tuning to avoid false positives and ensure the system is scalable as the company grows. While Snort is powerful for real-time detection, it can sometimes generate a high volume of alerts that might overwhelm the security team if not appropriately configured. A strategic recommendation is to pair Snort with centralised logging tools, such as Splunk, to reduce alert fatigue and prioritise critical incidents.
Splunk, as a Security Information and Event Management (SIEM) tool, offers excellent capabilities for collecting, indexing, and analysing log data from various sources, including firewalls, servers, and Snort. For Luna Bags, deploying Splunk would enable the security team to get real-time insights into network activity and security events, allowing for more informed decision-making. The implementation of Splunk can provide valuable data correlation, helping identify patterns that may indicate security incidents. However, Splunk's complex setup and high storage requirements may pose challenges. It is essential to implement proper data retention and indexing strategies to optimise its performance. Additionally, the security team must ensure that all critical network and server logs are properly configured to be ingested into Splunk to ensure comprehensive monitoring.
Firewall Policies should be carefully crafted to block unnecessary services and ensure that only essential traffic is allowed. The policies implemented on Luna Bags’ firewall should focus on restricting access to Telnet (port 23), which is inherently insecure, while allowing essential services like HTTP (port 80) for web access and SSH (port 22) for remote management. The firewall rules should also allow communication on high ephemeral ports (32768-61000) for dynamic network services. A key consideration is that overly restrictive firewall rules may hinder necessary communication for services, so policies should be continuously reviewed and adjusted based on operational needs. Another potential risk is that the firewall alone might not catch sophisticated attacks, which is why it's critical to complement it with IDS/IPS systems like Snort and a SIEM like Splunk for comprehensive protection.
Conclusion
In conclusion, while each of these tools—OpenVPN, Snort, Splunk, and the firewall—provides vital security measures, their combined use will create a multi-layered defence for Luna Bags. Regular testing, tuning, and updates will be necessary to ensure they are functioning optimally and reducing the risk of security breaches.






